{% extends "base.html" %}

{% block content %}
<nav class="breadcrumbs" aria-label="–•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a href="/" itemprop="item"><span itemprop="name">–ì–ª–∞–≤–Ω–∞—è</span></a>
      <meta itemprop="position" content="1" />
    </li>
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <span itemprop="name">{{ list_title }}</span>
      <meta itemprop="position" content="2" />
    </li>
  </ol>
</nav>

<section class="products-list-page">
  <header class="products-list-header animate-slide-up">
    <h1><span class="list-icon">{{ list_icon }}</span> {{ list_title }}</h1>
    <p class="products-list-subtitle">{{ list_subtitle }}</p>
  </header>

  {% if products %}
  <div class="product-grid" itemscope itemtype="https://schema.org/ItemList">
    {% for product in products %}
    <article class="product-card animate-scale-in" style="--delay: {{ loop.index0 * 0.05 }}s" itemprop="itemListElement" itemscope itemtype="https://schema.org/Product">
      <meta itemprop="position" content="{{ loop.index }}" />
      <a href="/product/{{ product.id }}-{{ product.slug }}" class="product-card-link">
        <div class="product-card-image">
          {% if product.image_url %}
          <img
            src="{{ product.image_url }}"
            alt="{{ product.name }}"
            itemprop="image"
            loading="lazy"
          />
          {% else %}
          <div class="product-placeholder">üë†</div>
          {% endif %}
          {% if product.is_new %}
          <span class="product-badge product-badge-new">–ù–æ–≤–∏–Ω–∫–∞</span>
          {% endif %}
          {% if product.old_price and product.old_price > product.price %}
          <span class="product-badge product-badge-sale">
            -{{ ((product.old_price - product.price) / product.old_price * 100) | int }}%
          </span>
          {% endif %}
        </div>
        <div class="product-card-body">
          <h3 class="product-card-title" itemprop="name">{{ product.name }}</h3>
          
          {% if product.subcategory and product.subcategory.category %}
          <div class="product-card-category">
            {{ product.subcategory.category.icon }} {{ product.subcategory.name }}
          </div>
          {% endif %}
          
          <div class="product-card-price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
            <span class="price" itemprop="price" content="{{ product.price }}">{{ product.price | int }} ‚ÇΩ</span>
            <meta itemprop="priceCurrency" content="RUB" />
            {% if product.old_price and product.old_price > product.price %}
            <span class="old-price">{{ product.old_price | int }} ‚ÇΩ</span>
            {% endif %}
          </div>
          
          {% if product.color %}
          <div class="product-card-color">{{ product.color }}</div>
          {% endif %}
        </div>
      </a>
    </article>
    {% endfor %}
  </div>
  {% else %}
  <div class="products-empty animate-slide-up">
    <div class="empty-icon">üì¶</div>
    <p>–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –ø–æ–∫–∞ –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</p>
    <a href="/" class="btn btn-primary">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
  </div>
  {% endif %}
</section>
{% endblock %}

