{% extends "base.html" %}

{% block head_extra %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Product",
  "name": "{{ product.name }}",
  "description": "{{ product.description or '' }}",
  "image": "{{ request.base_url | replace('//', '//') | replace('/$', '') }}{{ product.image_url }}",
  "sku": "{{ product.id }}",
  "brand": {
    "@type": "Brand",
    "name": "–ü–ª–∞–Ω–µ—Ç–∞ –û–±—É–≤–∏"
  },
  "offers": {
    "@type": "Offer",
    "url": "{{ request.url }}",
    "price": "{{ product.price }}",
    "priceCurrency": "RUB",
    "availability": "https://schema.org/InStock",
    "seller": {
      "@type": "Organization",
      "name": "–ü–ª–∞–Ω–µ—Ç–∞ –û–±—É–≤–∏ ‚Äî –¢–¶ ¬´–ê–ª–º–∞–∑¬ª"
    }
  }
}
</script>
{% endblock %}

{% block content %}
<nav class="breadcrumbs" aria-label="–•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    {% for bc in breadcrumbs %}
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      {% if loop.last %}
        <span itemprop="name">{{ bc.name }}</span>
      {% else %}
        <a href="{{ bc.url }}" itemprop="item"><span itemprop="name">{{ bc.name }}</span></a> /
      {% endif %}
      <meta itemprop="position" content="{{ loop.index }}" />
    </li>
    {% endfor %}
  </ol>
</nav>

<article class="product-detail" itemscope itemtype="https://schema.org/Product">
  <div class="product-detail-body">
    {% if product.image_url %}
    <div class="product-detail-image">
      <img
        src="{{ product.image_url }}"
        alt="{{ product.name }}"
        itemprop="image"
      />
      {% if product.is_new %}
      <span class="product-badge product-badge-new product-badge-large">–ù–æ–≤–∏–Ω–∫–∞</span>
      {% endif %}
      {% if product.old_price %}
      <span class="product-badge product-badge-sale product-badge-large">–°–∫–∏–¥–∫–∞</span>
      {% endif %}
    </div>
    {% endif %}

    <div class="product-detail-info">
      <header class="product-detail-header">
        <h1 itemprop="name">{{ product.name }}</h1>
      </header>

      <div class="product-detail-price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
        <span class="price" itemprop="price" content="{{ product.price }}">{{ product.price | int }} ‚ÇΩ</span>
        <meta itemprop="priceCurrency" content="RUB" />
        {% if product.old_price %}
        <span class="old-price">{{ product.old_price | int }} ‚ÇΩ</span>
        <span class="discount-percent">-{{ ((1 - product.price / product.old_price) * 100) | int }}%</span>
        {% endif %}
        <link itemprop="availability" href="https://schema.org/InStock" />
      </div>

      {% if product.color %}
      <div class="product-detail-attr">
        <span class="attr-label">–¶–≤–µ—Ç:</span>
        <span class="attr-value">{{ product.color }}</span>
      </div>
      {% endif %}

      {% if product.sizes_json %}
      <div class="product-detail-attr">
        <span class="attr-label">–†–∞–∑–º–µ—Ä—ã:</span>
        <span class="attr-value sizes-list">
          {% for size in product.sizes_json | parse_sizes %}
          <span class="size-tag">{{ size }}</span>
          {% endfor %}
        </span>
      </div>
      {% endif %}

      {% if product.description %}
      <div class="product-detail-description" itemprop="description">
        {{ product.description }}
      </div>
      {% endif %}

      <div class="product-detail-cta">
        <p>üìç –ü—Ä–∏—Ö–æ–¥–∏—Ç–µ –Ω–∞ –ø—Ä–∏–º–µ—Ä–∫—É!</p>
        <p><strong>–¢–¶ ¬´–ê–ª–º–∞–∑¬ª</strong>, —É–ª. –ö—É–π–±—ã—à–µ–≤–∞, 37, —Ü–æ–∫–æ–ª—å–Ω—ã–π —ç—Ç–∞–∂</p>
        <p>üìû <a href="tel:+79028018513">+7 (902) 801-85-13</a></p>
      </div>
    </div>
  </div>
</article>
{% endblock %}
